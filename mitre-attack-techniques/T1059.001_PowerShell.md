# T1059.001: PowerShell

### Summary

Adversaries use PowerShell to execute scripts and commands as part of their attack chain. Because PowerShell is a legitimate and powerful system administration tool installed by default on all modern Windows systems, it is a prime target for abuse (a "living-off-the-land" binary, or LOLBin).

### How It's Used by Adversaries

-   **Fileless Malware:** Executing malicious payloads directly in memory without writing to disk.
-   **Reconnaissance:** Gathering information about the system, network, and users (e.g., `Get-Process`, `Get-NetTCPConnection`).
-   **Lateral Movement:** Moving to other systems on the network, often using PowerShell Remoting or by executing commands on remote shares.
-   **Credential Theft:** Using frameworks like `Mimikatz` (often injected via PowerShell) to dump credentials from memory.
-   **Obfuscation:** PowerShell has powerful obfuscation capabilities (e.g., Base64 encoding, string manipulation) that adversaries use to hide their commands from simple signature-based detection.

### What to Look For (Detection)

-   Monitor process execution for `powershell.exe`.
-   Look for suspicious command-line arguments, such as `-EncodedCommand`, `-e`, `-enc` (Base64 encoded commands), `-NonI` (NonInteractive), `-W Hidden` (hidden window style).
-   Enable and collect PowerShell Script Block Logging (Event ID 4104) and Module Logging (Event ID 4103). These logs capture the de-obfuscated script content, providing full visibility into what was executed.
-   Monitor for network connections originating from `powershell.exe`.
-   Look for parent-child process relationships, such as Microsoft Word spawning `powershell.exe`, which is highly suspicious.
